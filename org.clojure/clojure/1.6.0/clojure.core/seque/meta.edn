{:added "1.0", :ns "clojure.core", :name "seque", :file "clojure/core.clj", :static true, :type :fn, :src "(defn seque\n  \"Creates a queued seq on another (presumably lazy) seq s. The queued\n  seq will produce a concrete seq in the background, and can get up to\n  n items ahead of the consumer. n-or-q can be an integer n buffer\n  size, or an instance of java.util.concurrent BlockingQueue. Note\n  that reading from a seque can block if the reader gets ahead of the\n  producer.\"\n  {:added \"1.0\"\n   :static true}\n  ([s] (seque 100 s))\n  ([n-or-q s]\n   (let [^BlockingQueue q (if (instance? BlockingQueue n-or-q)\n                             n-or-q\n                             (LinkedBlockingQueue. (int n-or-q)))\n         NIL (Object.) ;nil sentinel since LBQ doesn't support nils\n         agt (agent (lazy-seq s)) ; never start with nil; that signifies we've already put eos\n         log-error (fn [q e]\n                     (if (.offer q q)\n                       (throw e)\n                       e))\n         fill (fn [s]\n                (when s\n                  (if (instance? Exception s) ; we failed to .offer an error earlier\n                    (log-error q s)\n                    (try\n                      (loop [[x & xs :as s] (seq s)]\n                        (if s\n                          (if (.offer q (if (nil? x) NIL x))\n                            (recur xs)\n                            s)\n                          (when-not (.offer q q) ; q itself is eos sentinel\n                            ()))) ; empty seq, not nil, so we know to put eos next time\n                      (catch Exception e\n                        (log-error q e))))))\n         drain (fn drain []\n                 (lazy-seq\n                  (let [x (.take q)]\n                    (if (identical? x q) ;q itself is eos sentinel\n                      (do @agt nil)  ;touch agent just to propagate errors\n                      (do\n                        (send-off agt fill)\n                        (cons (if (identical? x NIL) nil x) (drain)))))))]\n     (send-off agt fill)\n     (drain))))", :column 1, :line 4940, :arglists ([s] [n-or-q s]), :doc "Creates a queued seq on another (presumably lazy) seq s. The queued\n  seq will produce a concrete seq in the background, and can get up to\n  n items ahead of the consumer. n-or-q can be an integer n buffer\n  size, or an instance of java.util.concurrent BlockingQueue. Note\n  that reading from a seque can block if the reader gets ahead of the\n  producer."}